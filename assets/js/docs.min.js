$(function(){

/*
$('.bs-docs-section').each(function() {

var ul = $('<ul class="nav bs-docs-sidenav">');
//var ul = $(this).find('ul').first();;
var rootUl = ul;

//ul.each(function() {

//Initialize the root UL
for (var i = 1; i < 8; i++) {
	var hs = $('h' + i);
	if (hs.length) {
		ul[0].childHeaders = hs
		ul[0].childHeaderLevel = i;
		break;
	}
}

while(ul.length){	
	var nextUl = $();
	ul.each(function(){
		 var innerUl = this;
		 var n = this.childHeaderLevel;
		 innerUl.childHeaders.each(function(i,elem) {
//console.info('<li><a href="#' + elem.id + '">' + $(elem).text() + '</a></li>\n');
			var childUl = $('<ul>').append('<li><a href="#' + elem.id + '">' + 
				$(elem).text() + '</a></li>\n').appendTo(innerUl);
//console.info(childUl.html());
			childUl[0].childHeaders = $(this).nextUntil('h' + n).filter('h' + (n+1));
			childUl[0].childHeaderLevel = n + 1;
			nextUl = nextUl.add(childUl);
	   });
	});
	ul = nextUl;
}

var h1 = rootUl.find('ul');
h1.each(function() {
	console.info($(this).html());
});

//	$(this).append(rootUl);
//	console.info(rootUl.html());
//	$('.bs-docs-sidenav').html(rootUl.html());

});

*/

var html = '';

$('.bs-docs-section').each(function() {
	var h1 = $(this).find('h1[id],h2[id]');
	if (h1.length) {
		var level = 1;
		h1.each(function() {
			if ($(this)[0].nodeName == 'H2') {
				if (level == 1) {
					html+='\n<ul class="nav">\n';
					level = 2;
				}
				html+='  <li><a href="#' + this.id +'">' + $(this)[0].innerText + '</a></li>\n';
			} else {
				if (level == 2) {
					html+='</ul>\n';
					level = 1;
				}
				if (html != '') {
					html += '</li>\n'
				}
				html+='<li><a href="#' + this.id +'">' + $(this)[0].innerText + '</a>';
			}
//			html+='<li><a href="#' + this.id +'">'+ $(this).clone().children().remove().end().text() +'</a>\n';
//console.info('name: ' + this.name + ' text: ' + this.text + '\n');
//console.info($(this));

/*
			html+= '<li><a href="#' + this.id +'">'+ $(this).clone().children().remove().end().text() +'</a>\n';
//			var h23 = this.find('h2[id], h3[id]');
			var h23 = $(this).find('h2[id]');
			if (h23.length) {
				html+= '<ul class="nav">\n';
				h23.each(function() {
					html += '<li><a href="#' + this.id +'">' +
						$(this).clone().children().remove().end().text() + '</a></li>\n';
				});
				html+= '</ul>\n';
			}
			html+= '</li>\n';
*/
		});
		if (level == 2) {
			html+='</ul>\n';
		}
		html+='</li>\n';
	}
});

//console.info(html);

if (html == '') {
	$('[role=complementary]').hide();
	$('[role=main]').toggleClass('col-md-8 col-md-12');
} else {
	$('.bs-docs-sidenav').html(html);
}

	/*!
	 * JavaScript for Bootstrap's docs (http://getbootstrap.com)
	 * Copyright 2011-2014 Twitter, Inc.
	 * Licensed under the Creative Commons Attribution 3.0 Unported License. For
	 * details, see http://creativecommons.org/licenses/by/3.0/.
	 */
/*
	!function(a){a(function(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var b=document.createElement("style");b.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.querySelector("head").appendChild(b)}{var c=a(window),d=a(document.body);a(".navbar").outerHeight(!0)+10}d.scrollspy({target:".bs-docs-sidebar"}),c.on("load",function(){d.scrollspy("refresh")}),a(".bs-docs-container [href=#]").click(function(a){a.preventDefault()}),setTimeout(function(){var b=a(".bs-docs-sidebar");b.affix({offset:{top:function(){var c=b.offset().top,d=parseInt(b.children(0).css("margin-top"),10),e=a(".bs-docs-nav").height();return this.top=c-e-d},bottom:function(){return this.bottom=a(".bs-docs-footer").outerHeight(!0)}}})},100),setTimeout(function(){a(".bs-top").affix()},100)})}(jQuery);
});
*/

	! function(a) {
		a(function() {
			if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
				var b = document.createElement("style");
				b.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")), document.querySelector("head").appendChild(b)
			} {
				var c = a(window),
					d = a(document.body);
				a(".navbar").outerHeight(!0) + 10
			}
			d.scrollspy({
				target: ".bs-docs-sidebar"
			}), c.on("load", function() {
				d.scrollspy("refresh")
			}), a(".bs-docs-container [href=#]").click(function(a) {
				a.preventDefault()
			}), setTimeout(function() {
				var b = a(".bs-docs-sidebar");
				b.affix({
					offset: {
						top: function() {
							var c = b.offset().top,
								d = parseInt(b.children(0).css("margin-top"), 10),
								e = a(".bs-docs-nav").height();
							return this.top = c - e - d
						},
						bottom: function() {
							return this.bottom = a(".bs-docs-footer").outerHeight(!0)
						}
					}
				})
			}, 100), setTimeout(function() {
				a(".bs-top").affix()
			}, 100)
		})
	}(jQuery);
	});

function trianglify(color1, color2) {
	var header = $('#content'),
		t = new Trianglify({
			cellsize: 90,
			noiseIntensity: 0,
			x_gradient: [color1, color2]
		}),
		pattern = t.generate(window.screen.width | header.outerWidth(), header.outerHeight()*1.2);

	header.css('background-image', pattern.dataUrl);
}
